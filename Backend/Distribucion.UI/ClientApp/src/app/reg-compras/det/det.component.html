<h3 class="title">Registro de Nueva Compra</h3>
 <div class="col-md-12 border">
   <div class="cuadros-group">
     <div class="input-group">
       <select [class]="txtClass" [(ngModel)]="proveedor" name="proveedor" aria-placeholder="Seleccione proveedor" (change)="getSaldoAnterior()" (keyup)="validacion()" onblur="checkInput(this)" style="padding:4px 0px">
         <option *ngFor="let prov of dataTemProveedor" value="{{prov.proveedorId}}">{{prov.proveedorName}}</option>
       </select>
       <label>
         Proveedor
         <span *ngIf="proveedor == null" class="alert-validation">*</span>
       </label>
     </div>
     <div class="input-group" style="margin:10px 0px">
       <select [class]="txtClass" [(ngModel)]="producto" name="producto" aria-placeholder="Seleccione producto" (change)="getSaldoAnterior(); obtenerEquivalencia();" (keyup)="validacion()" onblur="checkInput(this);" onchange="checkInput(document.getElementById('txtFleteUnit'));" style="padding:4px 0px">
         <option *ngFor="let prod of dataTempProducto |  filter : 'productLevel' : '1'" value="{{prod.productId}}">{{prod.productName}}</option>
       </select>
       <label>
         Producto
         <span *ngIf="producto == null" class="alert-validation">*</span>
       </label>
     </div>

     <div class="input-group">
       <input [class]="txtClass" id="txtFleteUnit" type="number" min="0" [(ngModel)]="fleteUnit" name="fleteUnit" onblur="checkInput(this);" >
       <label>
         Flete Unitario (S/)
         <span *ngIf="fleteUnit == null" class="alert-validation">*</span>
       </label>
     </div>

     <div class="input-group" style="margin: 10px;">
       <select [class]="txtClass" name="unidadMedida" [(ngModel)]="unidadMedida" (keyup)="validacion()" onblur="checkInput(this)" style="padding:4px 0px">
         <option *ngFor="let subum of equivalenciaFilter" value="{{subum.unidadBase}}">{{subum.unidadBase}}</option>
       </select>
       <label>
         Unidad Medida
         <span *ngIf="unidadMedida == null" class="alert-validation">*</span>
       </label>
     </div>
     <div class="input-group">
       <input [class]="txtClass" type="number" min="0" [disabled]="peso>0" [(ngModel)]="cantidad" (change)="calcularCostoTotal()" (keyup)="validacion()" name="cantidad" onblur="checkInput(this); checkInput(document.getElementById('txtCostoTotal')); checkInput(document.getElementById('txtSaldoAnterior')); checkInput(document.getElementById('txtSaldoDeposito'))">
       <label>
         Cantidad
         <span *ngIf="cantidad == null && peso == null" class="alert-validation">*</span>
       </label>
     </div>

     <!--<div class="input-group">
    <input [class]="txtClass" type="number" min="0" [(ngModel)]="peso" [disabled]="cantidad>0" (keyup)="validacion()" name="peso" onblur="checkInput(this); checkInput(document.getElementById('txtCantidadMalEstado'))">
    <label>
      Peso (Kg)
      <span *ngIf="cantidad == null && peso == null" class="alert-validation">*</span>
    </label>
  </div>-->

     <div class="input-group">
       <input [class]="txtClass" type="number" min="0" [(ngModel)]="precioUnitario" name="precioUnitario" (change)="calcularCostoTotal()" (keyup)="validacion()" onblur="checkInput(this); checkInput(document.getElementById('txtCostoTotal')); checkInput(document.getElementById('txtSaldoAnterior')); checkInput(document.getElementById('txtSaldoDeposito'))">
       <label>
         Precio Unitario (S/)
         <span *ngIf="precioUnitario == null" class="alert-validation">*</span>
       </label>
     </div>

     <div class="input-group">
       <input [class]="txtClass" id="txtCostoTotal" type="number" min="0" [(ngModel)]="precio" name="precio" (keyup)="validacion()">
       <label>
         Costo Total (S/)
         <span *ngIf="precio == null" class="alert-validation">*</span>
       </label>
     </div>
     <div class="input-group">

       <input [class]="txtClass" id="txtSaldoAnterior" type="number" [(ngModel)]="saldoAnterior" name="saldoAnterior" disabled>
       <label>Saldo anterior (S/)</label>
     </div>
     <div class="input-group">
       <input [class]="txtClass" type="number" min="0" [(ngModel)]="totalDeposito" (change)="calcularSaldo()" (keyup)="validacion()" name="totalDeposito" onblur="checkInput(this); checkInput(document.getElementById('txtSaldoDeposito'))">
       <label>
         Amortización (S/)
         <span *ngIf="totalDeposito == null" class="alert-validation">*</span>
       </label>
     </div>
     <div class="input-group">
       <input [class]="txtClass" id="txtSaldoDeposito" type="number" [(ngModel)]="saldoDeposito" name="saldoDeposito" disabled>
       <label>Saldo (S/)</label>
     </div>
     <div class="input-group">
       <input [class]="txtClass" id="txtDocumentoCompra" type="text" [(ngModel)]="documentoCompra" name="documentoCompra">
       <label>Doc. de compra</label>
     </div>

   </div>
     <button [disabled]="disabled" (click)="addToDetallesArray();
                checkInput(proveedor); checkInput(producto); checkInput(cantidad);checkInput(unidadMedida); checkInput(peso); checkInput(precio); checkInput(totalDeposito); checkInput(saldoDeposito); checkInput(fleteUnitario);">
       Registrar
     </button>
 </div>

  <div class="border">

    <h4 class="subtitle" style="text-align:center">Monto Total de Compra: S/ {{newCompra.totalCompra}}</h4>
    <br />
    <h4 class="subtitle" style="text-align:center">Costo del Flete Total: S/ {{newCompra.costoFlete}}</h4>
  </div>

  <div class=" border">

    <kendo-grid [data]="compradetKendo"
                [pageSize]="pageSize"
                [skip]="skip"
                (pageChange)="pageChange($event)"
                [pageable]="true">
      <kendo-grid-column title="Proveedor" width="120">
        <ng-template kendoGridCellTemplate let-dataItem>
          <p *ngFor="let prov of dataTemProveedor | filter : 'proveedorId' : dataItem.proveedorId ">{{prov.proveedorName}}</p>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column title="Producto" width="120">
        <ng-template kendoGridCellTemplate let-dataItem>
          <p *ngFor="let prod of dataTempProducto | filter : 'productId' : dataItem.productId ">{{prod.productName}}</p>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column field="cantidadCompra" title="Cant." width="70"></kendo-grid-column>
      <kendo-grid-column field="unidadMedida" title="U. M." width="90"></kendo-grid-column>
      <!--<kendo-grid-column field="pesoCompra" title="Peso" width="60"></kendo-grid-column>-->
      <kendo-grid-column field="precioUnitario" title="Precio Un." width="80"></kendo-grid-column>
      <kendo-grid-column field="precioCompra" title="Costo Total" width="90"></kendo-grid-column>
      <kendo-grid-column field="totalDeposito" title="Amortizac." width="90"></kendo-grid-column>
      <kendo-grid-column field="saldoDeposito" title="Saldo" width="90"></kendo-grid-column>
      <kendo-grid-column field="documentoCompra" title="Doc. de compra" width="90"></kendo-grid-column>
      <kendo-grid-column title="Flete unitario" width="90">
        <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
          {{dataItem.costoFleteItemCompra / dataItem.cantidadCompra}}
        </ng-template>
      </kendo-grid-column>
      <!--<kendo-grid-column field="costoFleteItemCompra" title="Flete unitario" width="90"></kendo-grid-column>-->
      <kendo-grid-column title="" width="50">
        <ng-template kendoGridCellTemplate let-dataItem>
          <a (click)="pasaDatos(dataItem.detalleCompraId); openMod('modal-eliminar')"><i class="icon-delete"></i></a>
        </ng-template>
      </kendo-grid-column>
    </kendo-grid>
  </div>
  <div class="row" style="text-align:center">
    <button style="margin:0 10px" class="btn btn-primary" (click)="backComponent()">< Regresar</button>
    <button style="margin:0 10px" class="btn btn-primary" (click)="nextComponent()">Siguiente ></button>
  </div>




<div class="modal" id="modal-eliminar">
  <div class="cd-popup-container">
    <input type="hidden" #idEliminar value="{{IDEliminar}}" />
    <p>¿Desea eliminar este elemento</p>
    <ul class="cd-buttons">
      <li><a (click)="deleteDetalleFromArray(idEliminar.value); closeMod('modal-eliminar');">Si</a></li>
      <li><a (click)="closeMod('modal-eliminar')">No</a></li>
    </ul>
    <a (click)="closeMod('modal-gasto-el')" class="cd-popup-close img-replace">Close</a>
  </div>
</div>


<div>
  <div class="sweet-overlay" tabindex="-1" style="opacity: 0; display: none;">
  </div>
  <div class="sweet-alert hideSweetAlert" tabindex="-1" data-has-cancel-button="false" data-allow-ouside-click="false" data-has-done-function="false" style="display: none; margin-top: -176px; opacity: -0.01;">
    <div class="icon error" style="display: block;">
      <span class="x-mark"><span class="line left"></span><span class="line right"></span></span>
    </div>
    <div class="icon warning" style="display: none;">
      <span class="body"></span> <span class="dot"></span>
    </div>
    <div class="icon info" style="display: none;">
    </div>
    <div class="icon success" style="display: none;">
      <span class="line tip"></span> <span class="line long"></span>
      <div class="placeholder">
      </div>
      <div class="fix"></div>
    </div>
    <div class="icon custom" style="display: none;"></div>
    <h2>Cancelled</h2>
    <p style="display: block;">Your imaginary file is safe :)</p>
    <button class="cancel" tabindex="-1" style="display: none; box-shadow: none;">Cancel</button>
    <button class="confirm" tabindex="-1" style="display: none; box-shadow: none;">OK</button>
    <button class="btn w-xs btn-info" tabindex="-1" style="display:none;  box-shadow: none;">Cerrar</button>
  </div>
</div>
